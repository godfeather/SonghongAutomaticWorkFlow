# SonghongAutomaticWorkFlow
# 淞泓智能汽车办公自动化系统流程测试工具

淞泓流程测试工具用于对淞泓系统的流程逻辑进行测试，主要功能包含一下：
+ 流程计算： 通过发起人和流程名称计算出流程审核通过时需要经过的每一个审核者。
+ 自动化流程审核：基于流程计算结果，自动登录每一个审核者的账号对指定流程标题的流程进行自动化审核，直到流程结束。
+ 手动流程：手动流程是指通过人工计算流程中每个节点的审核者，并将审核者序列输入后，对指定流程标题的流程进行自动化审核，直到结束。
+ 流程驳回审核：若在执行自动化审核前指定流程--reject 选项并提供有效驳回间隔，则在流程中会审核“不同意”值，直到结束。

### 环境配置：
1. 数据库： 安装sqlserver或mysql,mysql需要8以上；
2. geckroDriver: 火狐浏览器驱动，需要将其加到环境变量path变量中。macOS或Linux参考下面的命令配置
  cd 包含geckroDriver的目录
  sudo echo '# Firefox 驱动' >> /etc/profile
  sudo echo 'export GECKRO_DRIVER=`pwd` >> /etc/profile
  sudo echo 'export PATH=${GECKRO_DRIVER}:${PATH}' >> /etc/profile
  source /etc/profile
3. jre ： java运行环境
  在oracle官网下载jre或jdk并安装，并在控制台或终端输入“java”，若有大量文字输出，则表示安装成功；若出现例如“未找到”或“not found”则说明未成功安装；检查环境变量是否正确配置。
### 程序配置文件：
    首次运行程序时（可通过\[java -jar 程序包\]运行指定jar包）程序会在当前目录创建properties/properties.txt文件；该程序即程序运行时配置文件；首次使用配置文件时，需阅读理解配置文件中的注释行意义，完全理解后可将其中的‘#’开始的注释行删除，以方便配置。
    若配置文件错误或损坏时可直接删除properties目录并重新执行程序即可生成新的配置文件
### 数据库
  固定库名：mrright_songhongoa
  数据表：flow
   flow : 流程表，用于定义流程申明;字段信息：
   |列名|数据类型(长度)|描述|
   |:----:|:----:|:----:|
   |name|nvarchar(20)|流程名称，通过流程名称访问流程申明序列|
      name nvarchar(20): 流程名称，通过流程名称访问流程申明序列
      flow nvarchar(300): 流程申明序列
   staff : 用于存储员工信息；字段信息：
      account varchar(20) : 登录账号
      name varchar(20): 对应人员的真实姓名
      level int: 岗位级别，程序中通过发起人该值的大小和流程申明中每一个节点比较，若该值比节点中人员的值大，则跳过该人员审核
      post varchar(20): 岗位
      department varchar(20): 部门
### 程序中定义的流程基础逻辑：
    语义定义：
      必过节点：指无论如何都需要由指定人员审核的节点，节点所属岗位不分上下级关系，因此不参与流程基础逻辑，即流程申明中包含则最终流程生成后就一定存在；例如“申请人”，“会计”，“课题负责人”等
      非必过节点：审核节点中岗位有明确等级的为“非必过节点”，(如总经理 > 分管副总 > 执行总监，像这样能比较职位大小的为非必过节点)，非必过节点会因为下面的逻辑导致最终生成的流程序列中跳过不必要的审核；
  1. **非必过节点**中发起者不需要自己审核
  2. **非必过节点**中连续节点同一人审核时会跳过前面的节点并保留其中的最后一个节点
  3. 上级发起流程不需要非必过节点的下级审核
